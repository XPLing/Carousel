"user strict";!function(t,o,e){function i(t){var o=this;o.posterWrap=t,o.posterItems=o.posterWrap.find(".g-carousel-item"),o.posterNum=o.posterItems.size(),o.posterlist=o.posterWrap.find(".g-carousel-list"),o.posterFirst=o.posterItems.first(),o.posterLastItem=o.posterItems.last(),o.btns=o.posterWrap.find(".g-carousel-btn"),o.prevBtn=o.posterWrap.find(".g-carousel-btn-prev"),o.nextBtn=o.posterWrap.find(".g-carousel-btn-next");var i=o.getSetting();if(o.options=e.extend({},s,i),o.options.width<1){var r=o.posterWrap.parent().outerWidth()*o.options.width;o.options.width=r}o.options.Tile&&(o.options.width=o.options.posterWidth),o.btnW=o.options.width-o.options.posterWidth==0?.3*o.options.posterWidth:(o.options.width-o.options.posterWidth)/2,o.initialize(),o.rotateFinish=!0}var s={width:1e3,height:270,posterWidth:640,posterHeight:270,scale:.9,speed:500,autoPlay:!0,delay:5e3,verticalAlign:"middle",btnHover:!0,opacity:!1,Tile:!1};i.prototype={constructor:i,initialize:function(){if(0==this.posterNum)return!1;var t=this;if(/\%/.test(t.options.width)){var o=t.posterWrap.outerWidth();t.options.width=o}var i=t.posterNum%2==0?Math.ceil((t.posterNum+1)/2):Math.ceil(t.posterNum/2),s=t.options.Tile?0:t.btnW;if(t.posterWrap.css({width:t.options.width,height:t.options.height}),t.posterlist.css({"z-index":i,width:t.options.width,height:t.options.height}),t.posterFirst.css({"z-index":i,left:s,top:t.setVerticalAlign(t.options.posterHeight),opacity:1,width:t.options.posterWidth,height:t.options.posterHeight}),t.btns.css({"z-index":i+1,width:t.btnW,height:t.options.height}),t.posterNum>1){if(t.sortPosters(),t.bindEvents(),t.options.btnHover){t.btns.hover(function(){$this=e(this),$this.stop(!0).animate({opacity:.8},100)},function(){$this=e(this),$this.stop(!0).animate({opacity:0},100)})}else t.btns.addClass("m-carousel-active");t.options.autoPlay&&(t.autoPlay(),t.posterWrap.hover(function(){t.autoPlayTimer&&clearInterval(t.autoPlayTimer)},function(){t.autoPlay()}))}},bindEvents:function(){var t=this;t.prevBtn.on("click",function(){t.rotateFinish&&t.carouseRotate("right")}),t.nextBtn.on("click",function(){t.rotateFinish&&t.carouseRotate("left")})},carouseRotate:function(t){var o=this,i=[];"right"==t?o.posterItems.each(function(t){o.rotateFinish=!1;var s=e(this),r=s.next().get(0)?s.next():o.posterFirst;o.carouseRotateSetStyle(s,r,i)}):"left"==t&&o.posterItems.each(function(t){o.rotateFinish=!1;var s=e(this),r=s.prev().get(0)?s.prev():o.posterLastItem;o.carouseRotateSetStyle(s,r,i)}),o.posterItems.each(function(t){var o=e(this);o.css({"z-index":i[t]})})},carouseRotateSetStyle:function(t,o,e){var i=this,s=o.outerWidth(),r=o.outerHeight(),p=o.css("left"),n=o.css("top"),a=o.css("z-index"),h=o.css("opacity"),p=o.css("left");e.push(a),t.animate({top:n,left:p,opacity:h,width:s,height:r},i.options.speed,function(){i.rotateFinish=!0})},autoPlay:function(){var t=this;clearInterval(t.autoPlayTimer),t.autoPlayTimer=setInterval(function(){t.nextBtn.trigger("click")},t.options.delay)},setVerticalAlign:function(t){var o=this,e=o.options.verticalAlign,i=0;return i="middle"===e?(o.options.height-t)/2:"top"===e?0:"bottom"===e?o.options.height-t:(o.options.height-t)/2},sortPosters:function(){var t=this,o=Math.ceil(t.posterNum/2),i=Math.floor((t.posterNum-1)/2);if(t.options.Tile){for(var s=t.options.posterWidth,r=1;r<o;r++){var p=e(t.posterItems[r]),n=t.posterItems.eq(r-1).outerWidth(),a=t.posterItems.eq(r-1).css("left").replace("px","");a=Number(a);var h=t.options.posterWidth*Math.pow(t.options.scale,r),c=t.options.posterHeight*Math.pow(t.options.scale,r),l=s*r,u=t.setVerticalAlign(c),d=Math.ceil((t.posterNum-1)/2)-(r-1),f=1==r?1:t.options.opacity?t.options.opacity:1/r;p.css({"z-index":d,top:u,opacity:f,left:l,width:h,height:c})}for(var m=t.posterNum-1;m>i;m--){var g=e(t.posterItems[m]),v=t.posterNum-m,d=m-i,y=t.options.posterWidth*Math.pow(t.options.scale,v),w=t.options.posterHeight*Math.pow(t.options.scale,v),W=-v*s,N=t.setVerticalAlign(w),f=m==t.posterNum-1?1:t.options.opacity?t.options.opacity:1/v;g.css({"z-index":d,top:N,left:W,opacity:f,width:y,height:w})}}else if(0==i){var x=e(t.posterItems[1]),I=t.options.posterWidth,a=t.posterFirst.css("left").replace("px","");a=Number(a);var b=I*Math.pow(t.options.scale,1),M=t.options.posterHeight*Math.pow(t.options.scale,1),g=a+(I-b)/2,z=t.setVerticalAlign(M),d=1,f=.5;x.css({"z-index":d,top:z,left:g,opacity:f,width:b,height:M})}else{for(var r=1;r<o;r++){var p=e(t.posterItems[r]),n=t.posterItems.eq(r-1).outerWidth(),a=t.posterItems.eq(r-1).css("left").replace("px","");a=Number(a);var s=t.btnW/Math.floor((t.posterNum-1)/2),h=t.options.posterWidth*Math.pow(t.options.scale,r),c=t.options.posterHeight*Math.pow(t.options.scale,r),l=n-(h-s)+a,u=t.setVerticalAlign(c),d=Math.ceil((t.posterNum-1)/2)-(r-1),f=1==r?1:t.options.opacity?t.options.opacity:1/r;p.css({"z-index":d,top:u,opacity:f,left:l,width:h,height:c})}for(var m=t.posterNum-1;m>i;m--){var g=e(t.posterItems[m]),v=t.posterNum-m,d=m-i,s=t.btnW/Math.ceil((t.posterNum-1)/2),y=t.options.posterWidth*Math.pow(t.options.scale,v),w=t.options.posterHeight*Math.pow(t.options.scale,v),W=(m-i-1)*s,N=t.setVerticalAlign(w),f=m==t.posterNum-1?1:t.options.opacity?t.options.opacity:1/v;g.css({"z-index":d,top:N,left:W,opacity:f,width:y,height:w})}}},getSetting:function(){var t=this,o=t.posterWrap.attr("data-setting");return o=JSON.parse(o),o?o:{}}},i.init=function(){var t=Array.prototype.slice.apply(arguments),o=this,i=e(t[0]);return i.each(function(){var t=e(this);if(!t.data("Carousel")){var i=new o(t);t.data("Carousel",i)}})},i.events=function(t){t=e(t);var o=t.data("Carousel");return o},t.xplCarousel=i}(window,document,jQuery);